% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/BetterVis_Heatmap_Multi.R
\name{BetterVis_Heatmap_Multi}
\alias{BetterVis_Heatmap_Multi}
\title{Create a Multi-Layered Heatmap with Annotations}
\usage{
BetterVis_Heatmap_Multi(
  df,
  x_var,
  number_vars = NULL,
  annotation_var = NULL,
  color_heatmap = MetBrewer::met.brewer("Cassatt1"),
  color_annotation = NULL,
  legend_heatmap_position = "right",
  legend_annotation_position = c(1.3, -4),
  heatmap_theme = theme(),
  annotation_theme = theme(),
  heatmap_plot_margin = unit(c(0, 2, -20, 0.5), "cm")
)
}
\arguments{
\item{df}{A data frame containing the data for plotting.}

\item{x_var}{A character string specifying the column name for the x-axis variable (e.g., sample IDs).}

\item{number_vars}{(Optional) A character vector of column names for the numeric variables to include in the main heatmap. If `NULL`, all numeric columns are used.}

\item{annotation_var}{(Optional) A character vector of column names for the categorical variables to include in the annotation heatmap.}

\item{color_heatmap}{A vector of colors for the main heatmap's gradient. Defaults to a `MetBrewer` palette.}

\item{color_annotation}{(Optional) A list of color vectors for the annotation tracks. The list should have the same length as `annotation_var`.}

\item{legend_heatmap_position}{The position for the main heatmap's legend. Can be a character string (e.g., "right") or a numeric vector `c(x, y)`.}

\item{legend_annotation_position}{The position for the annotation legend(s).}

\item{heatmap_theme, annotation_theme}{(Optional) A `theme()` object to apply custom theme settings to the respective plots.}

\item{heatmap_plot_margin}{A `unit` object specifying the margins for the main heatmap.}
}
\value{
A `patchwork` object.
}
\description{
This function generates a composite plot featuring a main heatmap for numeric
data stacked below an annotation heatmap for categorical data. It uses `patchwork`
for layout and `ggnewscale` to support multiple color scales.
}
\examples{
if (requireNamespace("ggnewscale", quietly = TRUE) &&
    requireNamespace("patchwork", quietly = TRUE)) {
   library(MetBrewer)
  # Load example data
  data("BetterVis_Heatmap_Multi_example", package = "BetterVis")

  # Define a list of color palettes for the annotations
  color_annotation <- list(
    c("#E31A1C", "#FDBF6F"),
    c("#A6CEE3", "#1F78B4", "#B2DF8A", "#33A02C", "#FB9A99"),
    c("#FF7F00", "#CAB2D6")
  )

  # Generate the plot
  BetterVis_Heatmap_Multi(
    df = BetterVis_Heatmap_Multi_example,
    x_var = "case.ID",
    annotation_var = c("Primary Metastasis", "Consensus classification", "UNC classification"),
    color_heatmap = met.brewer("Cassatt1"),
    color_annotation = color_annotation,
    legend_heatmap_position = c(1.08, 0.7),
    legend_annotation_position = c(1.22, -4),
    heatmap_theme = theme(axis.text.y = element_text(face = "bold")),
    annotation_theme = theme(
      axis.text.y = element_text(face = "bold"),
      legend.title = element_text(face = "bold"),
      legend.text = element_text(face = "bold")
    )
  )
}

}
